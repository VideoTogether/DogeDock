!function(e){function t(t){for(var n,r,s=t[0],l=t[1],o=t[2],u=0,d=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(p&&p(t);d.length;)d.shift()();return c.push.apply(c,o||[]),a()}function a(){for(var e,t=0;t<c.length;t++){for(var a=c[t],n=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(n=!1)}n&&(c.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},r={2:0},i={2:0},c=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.e=function(e){var t=[];r[e]?t.push(r[e]):0!==r[e]&&{1:1,3:1}[e]&&t.push(r[e]=new Promise((function(t,a){for(var n="css/"+({0:"404",1:"account",3:"app-details"}[e]||e)+"."+{0:"530074",1:"c166de",3:"7266c9"}[e]+".css",i=s.p+n,c=document.getElementsByTagName("link"),l=0;l<c.length;l++){var o=(p=c[l]).getAttribute("data-href")||p.getAttribute("href");if("stylesheet"===p.rel&&(o===n||o===i))return t()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){var p;if((o=(p=u[l]).getAttribute("data-href"))===n||o===i)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var n=t&&t.target&&t.target.src||i,c=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=n,delete r[e],d.parentNode.removeChild(d),a(c)},d.href=i,document.getElementsByTagName("head")[0].appendChild(d)})).then((function(){r[e]=0})));var a=i[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise((function(t,n){a=i[e]=[t,n]}));t.push(a[2]=n);var c,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=function(e){return s.p+"js/"+({0:"404",1:"account",3:"app-details"}[e]||e)+"."+{0:"530074",1:"c166de",3:"7266c9"}[e]+".js"}(e);var o=new Error;c=function(t){l.onerror=l.onload=null,clearTimeout(u);var a=i[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;o.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",o.name="ChunkLoadError",o.type=n,o.request=r,a[1](o)}i[e]=void 0}};var u=setTimeout((function(){c({type:"timeout",target:l})}),12e4);l.onerror=l.onload=c,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var l=window.webpackJsonp=window.webpackJsonp||[],o=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var p=o;c.push([175,4]),a()}({158:function(e,t,a){},160:function(e,t,a){},168:function(e,t,a){},169:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},173:function(e,t,a){},175:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(69),c=a.n(i),s=a(17),l=a(22),o=a(80),u=a(81),p=a(70),d=a(71),h=a(72),f=a(73),m=a(74),v=a(82),y=a(75),g=a(83),E=a(76),C=a(84),I=a(85),T=a(79),b=a(86),_=a(77),S=a(48),A=a(49);l.a.use([o.a,u.a,p.a,d.a,S.a,h.a,f.a,m.a,v.a,y.a,g.a,E.a,C.a,I.a,T.a,b.a,A.a,_.a]);var P=l.a,w=(a(158),a(159),a(160),a(11)),k=a.n(w),O=a(15),D=a.n(O),x=a(20),M=a.n(x),L=a(27),N=a.n(L),U=a(78),j=a.n(U),R=a(8),H=Object(n.createContext)({state:{ChatList:[],My:{LibraryPlaylists:[]}},dispatch:function(){}}),W=a(2),K=a(63),Y=a(67),F=a(57),G=a(64),J=a(65),B=a(55),V=a(66),X=a(68),q=a(36),z=a(28),Z=a(53),Q=a(54),$=a(56),ee={skipWaitingSent:!1,registration:null,serviceWorkerPendingUpdate:!1,listenForWaitingServiceWorker:function(e){function t(){e.installing.addEventListener("statechange",(function(){"installed"===this.state&&ee.promptUserToRefresh(e)}))}e&&(e.waiting?ee.promptUserToRefresh(e):(e.installing&&t(),e.addEventListener("updatefound",t)))},promptUserToRefresh:function(e){e&&e.waiting&&(ee.skipWaitingSent=!0,e.waiting.postMessage("skipWaiting"),ee.serviceWorkerPendingUpdate=!0)},init:function(){var e;"serviceWorker"in window.navigator&&(window.navigator.serviceWorker.register("./service-worker.js",{scope:"/"}).then((function(e){ee.registration=e,ee.listenForWaitingServiceWorker(e)})),navigator.serviceWorker.addEventListener("controllerchange",(function(){!e&&ee.skipWaitingSent&&(e=!0)})))}},te=ee,ae=a(52),ne=a.n(ae),re=(a(168),function(e){var t=e.title,a=e.heading,n=e.accountLink,i=void 0===n||n;return(r.a.createElement("h1",{className:"appstore-page-title"},a&&r.a.createElement("div",{className:"appstore-page-title-heading"},a),r.a.createElement("span",null,t),i&&r.a.createElement(z.a,{href:"/account/"},r.a.createElement("img",{src:ne.a,alt:"Account"}))))}),ie=(a(169),function(e){var t=e.title,a=e.navbarHeading,n=e.noCollapsedNavbar,i=e.children;return(r.a.createElement(S.a,{className:"appstore-page ".concat(n?"appstore-page-no-collapsed-navbar":"")},t&&r.a.createElement(re,{title:t,heading:a}),i))}),ce=(a(170),a(171),a(87),function(){return r.a.createElement(ie,{title:"DogeDock"},r.a.createElement($.a,null,"Work in progress"))}),se=a(178);function le(e){return"https://dogedock.2gether.video:5001"+e}var oe={Types:{REFRESH_CHAT_LIST:"REFRESH_CHAT_LIST",JOIN_CHAT:"JOIN_CHAT",UPDATE_CURRENT_CHAT_DETAIL:"UPDATE_CURRENT_CHAT_DETAIL",UPDATE_LIBRARY_PLAYLISTS:"UPDATE_LIBRARY_PLAYLISTS",OPEN_PLAYLIST:"OPEN_PLAYLIST",UPDATE_CURRENT_OPNED_PLAYLIST:"UPDATE_CURRENT_OPNED_PLAYLIST",UPDATE_MUSIC_PLAYER_DETAIL:"UPDATE_MUSIC_PLAYER_DETAIL",APPEND_CURRENT_CHAT_MESSAGE:"APPEND_CURRENT_CHAT_MESSAGE",UPDATE_USER_ID:"UPDATE_USER_ID"},DispathUpdateChatListAction:function(e,t){t({type:this.Types.UPDATE_CHAT_LIST,data:e})},ExitChat:function(e){e({type:"EXIT_CHAT"})},JoinChat:function(e,t){var a=this;this.ExitChat(t),t({type:this.Types.JOIN_CHAT,data:{Id:e,ScheduledTaskId:setInterval((function(){a.FetchChatAsync(e,t)}),1e4)}}),this.FetchChatAsync(e,t)},UpdateMusicPlayerDetail:function(e,t,a,n){n({type:this.Types.UPDATE_MUSIC_PLAYER_DETAIL,data:{Progress:e,Name:t,Image:a}})},OpenPlaylistAsync:function(e,t){var a=this;return D()(k.a.mark((function n(){var r;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t({type:a.Types.OPEN_PLAYLIST,data:e}),n.prev=1,n.next=4,MusicKit.getInstance().api.library.playlist(e);case 4:r=n.sent,t({type:a.Types.UPDATE_CURRENT_OPNED_PLAYLIST,data:r}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),console.error(n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()},CreateChatAsync:function(e,t,a,n){var r=this;return D()(k.a.mark((function a(){var i;return k.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch(le("/chat/update"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Songs:e,Name:t})});case 2:return a.next=4,a.sent.json();case 4:i=a.sent,console.log(i),r.JoinChat(i.ID,n);case 7:case"end":return a.stop()}}),a)})))()},FetchChatAsync:function(e,t){var a=this;return D()(k.a.mark((function n(){var r;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(le("/chat/get?id="+e));case 2:return n.next=4,n.sent.json();case 4:r=n.sent,t({type:a.Types.UPDATE_CURRENT_CHAT_DETAIL,data:r});case 6:case"end":return n.stop()}}),n)})))()},FetchMessageAsync:function(e,t,a){var n=this;return D()(k.a.mark((function r(){var i;return k.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch(le("/message/get?ChatID=".concat(e,"&Offset=").concat(t)));case 2:return r.next=4,r.sent.json();case 4:i=r.sent,a({type:n.Types.APPEND_CURRENT_CHAT_MESSAGE,data:i});case 6:case"end":return r.stop()}}),r)})))()},FetchChatList:function(e,t,a,n){this.DispathUpdateChatListAction([].concat(N()(a.ChatList),N()(Array(t).map((function(e){})))),n)},RefreshChatListAsync:function(e,t){var a=this;return D()(k.a.mark((function e(){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(le("/chats"));case 2:return e.next=4,e.sent.json();case 4:n=e.sent,t({type:a.Types.REFRESH_CHAT_LIST,data:n});case 6:case"end":return e.stop()}}),e)})))()},FetchLibraryPlayListsAsync:function(e,t){var a=this;return D()(k.a.mark((function e(){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,MusicKit.getInstance().api.library.playlists();case 2:n=e.sent,console.log(n),t({type:a.Types.UPDATE_LIBRARY_PLAYLISTS,data:n});case 5:case"end":return e.stop()}}),e)})))()},SendMessageAsync:function(e,t,a){var n=this;return D()(k.a.mark((function r(){var i,c;return k.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return null==localStorage.getItem("UserId")&&localStorage.setItem("UserId",se.a()),c=localStorage.getItem("UserId"),null==(null===(i=t.User)||void 0===i?void 0:i.Id)&&a({type:n.Types.UPDATE_USER_ID,data:localStorage.getItem("UserId")}),r.next=5,fetch(le("/message/send"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Text:e,SenderId:c,SenderName:c,ChatID:t.CurrentChat.Id})});case 5:case"end":return r.stop()}}),r)})))()}},ue=function(){var e,t,a,i,c,s=Object(n.useContext)(H),l=s.state,o=s.dispatch;return r.a.createElement(X.a,{className:"popup-library-playlist",swipeToClose:!0},r.a.createElement(S.a,null,r.a.createElement(F.a,{title:"Songs"},r.a.createElement(q.a,null,r.a.createElement(z.a,{popupClose:!0},"Close"))),r.a.createElement(B.a,{onClick:D()(k.a.mark((function e(){var t,a,n,r,i,c,s,u,p,d,h;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(null===(t=l.OpenedPlaylist)||void 0===t||null===(a=t.Playlist)||void 0===a||null===(n=a.relationships)||void 0===n||null===(r=n.tracks)||void 0===r?void 0:r.data),null==l.OpenedPlaylist.Playlist){e.next=7;break}return h=null===(i=l.OpenedPlaylist)||void 0===i||null===(c=i.Playlist)||void 0===c||null===(s=c.relationships)||void 0===s||null===(u=s.tracks)||void 0===u||null===(p=u.data)||void 0===p?void 0:p.map((function(e){var t,a,n;return{SID:null===(t=e.attributes)||void 0===t||null===(a=t.playParams)||void 0===a?void 0:a.catalogId,Duration:e.attributes.durationInMillis/1e3,Name:null===(n=e.attributes)||void 0===n?void 0:n.name}})).filter((function(e){return null!=e.SID})),console.log(h),e.next=6,oe.CreateChatAsync(h,null===(d=l.OpenedPlaylist)||void 0===d?void 0:d.Playlist.attributes.name,l,o);case 6:W.a.popup.close(".popup-library-playlist");case 7:case"end":return e.stop()}}),e)})))},"播放"),r.a.createElement(Z.a,{mediaList:!0},null===(e=l.OpenedPlaylist)||void 0===e||null===(t=e.Playlist)||void 0===t||null===(a=t.relationships)||void 0===a||null===(i=a.tracks)||void 0===i||null===(c=i.data)||void 0===c?void 0:c.map((function(e){var t,a,n;return(r.a.createElement(Q.a,{key:e.id,title:null==e||null===(t=e.attributes)||void 0===t?void 0:t.name},r.a.createElement("img",{style:{width:"80px",height:"80px"},slot:"media",src:null===(a=e.attributes)||void 0===a||null===(n=a.artwork)||void 0===n?void 0:n.url.replace("{w}x{h}","80x80"),alt:""})))})))))},pe=function(){var e=Object(n.useContext)(H),t=e.state,a=e.dispatch;return Object(n.useEffect)((function(){oe.FetchLibraryPlayListsAsync(t,a)}),[]),r.a.createElement(ie,{title:"我的"},r.a.createElement(B.a,{onClick:D()(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe.FetchLibraryPlayListsAsync(t,a);case 2:case"end":return e.stop()}}),e)})))},"刷新"),r.a.createElement(Z.a,{mediaList:!0},t.My.LibraryPlaylists.map((function(e){var t,n;return(r.a.createElement(Q.a,{title:e.attributes.name,key:e.id,popupOpen:".popup-library-playlist",onClick:D()(k.a.mark((function t(){return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,oe.OpenPlaylistAsync(e.id,a);case 2:case"end":return t.stop()}}),t)}))),link:"#"},r.a.createElement("img",{style:{width:"80px",height:"80px"},slot:"media",src:null===(t=e.attributes)||void 0===t||null===(n=t.artwork)||void 0===n?void 0:n.url,alt:""})))}))),r.a.createElement(ue,null))},de=function(){var e=Object(n.useContext)(H),t=e.state,a=e.dispatch;Object(n.useEffect)((function(){oe.RefreshChatListAsync(10,a)}),[]);var i=Object(n.useRef)(!0),c=Object(n.useState)(!0),s=M()(c,2),l=s[0],o=s[1];return r.a.createElement(ie,{title:"聊聊"},r.a.createElement(S.a,{ptr:!0,ptrMousewheel:!0,onPtrRefresh:function(e){console.log(123),oe.RefreshChatListAsync(10,a),e()},infinite:!0,infiniteDistance:50,infinitePreloader:l,onInfinite:function(){console.log("load"),i.current&&(i.current=!1,o(!1))}},r.a.createElement($.a,null,"聊聊， 下拉刷新"),r.a.createElement(B.a,{onClick:function(){MusicKit.getInstance().authorize()}},"登录 Apple Music"),r.a.createElement(Z.a,{mediaList:!0},t.ChatList.map((function(e){return r.a.createElement(Q.a,{onClick:function(){var n;(null===(n=t.CurrentChat)||void 0===n?void 0:n.Id)!=e.ID?(oe.JoinChat(e.ID,a),a({type:"SHOW_CHAT_MESSAGE_WINDOW"})):a({type:"SHOW_CHAT_MESSAGE_WINDOW"})},link:"#",title:e.Name,subtitle:"music name"},r.a.createElement("img",{slot:"media",src:"https://2gether.video/logo.png",width:"80"}))})))))},he=(a(173),a(174),a(58)),fe=a(59),me=a(60),ve=a(61),ye=function(){var e,t,a=Object(n.useContext)(H),i=a.state,c=a.dispatch,s=Object(n.useState)(""),l=M()(s,2),o=l[0],u=l[1],p=function(){var e=D()(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o.length>0)){e.next=4;break}return e.next=3,oe.SendMessageAsync(o,i,c);case 3:u("");case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(S.a,{noToolbar:!0,className:"chat-page"},r.a.createElement(he.a,{value:o,onInput:function(e){return u(e.target.value)}},r.a.createElement(z.a,{iconIos:"f7:arrow_up_circle_fill",iconAurora:"f7:arrow_up_circle_fill",iconMd:"material:send",slot:"inner-end",onClick:p})),r.a.createElement(fe.a,null,r.a.createElement(me.a,null),null===(e=i.CurrentChat)||void 0===e||null===(t=e.Messages)||void 0===t?void 0:t.map((function(e,t){var a;return(r.a.createElement(ve.a,{key:t,type:e.SenderId==(null===(a=i.User)||void 0===a?void 0:a.Id)?"sent":"received",name:e.SenderId,first:!0,last:!0,tail:!0},e.Text&&r.a.createElement("span",{slot:"text"},e.Text)))}))))},ge=a(62),Ee=[{path:"/",component:function(){var e=Object(n.useState)("chat-list"),t=M()(e,2),a=t[0],i=t[1],c=Object(n.useRef)(null);Object(n.useEffect)((function(){c.current=a}),[a]),Object(n.useEffect)((function(){if((W.a.device.ios||W.a.device.android)&&W.a.device.standalone){var e=document.querySelector('meta[name="viewport"]').getAttribute("content");document.querySelector('meta[name="viewport"]').setAttribute("content","".concat(e,", maximum-scale=1, user-scalable=no"))}}),[]);function s(e){c.current===a&&a===e&&Object(R.default)("#view-".concat(e))[0].f7View.router.back()}return(te.init(),r.a.createElement(S.a,null,r.a.createElement(ge.a,{tabs:!0,className:"safe-areas"},r.a.createElement(A.a,{tabbar:!0,labels:!0,bottom:!0},r.a.createElement(z.a,{onClick:function(){return s("search")},tabLink:"#view-chat-list",iconF7:"chat_bubble_2_fill",text:"聊聊",tabLinkActive:!0}),r.a.createElement(z.a,{onClick:function(){return s("apps")},tabLink:"#view-apps",iconF7:"music_house",text:"瞬间"}),r.a.createElement(z.a,{onClick:function(){return s("arcade")},tabLink:"#view-arcade",iconF7:"person_crop_circle",text:"我的"})),r.a.createElement(Y.a,{id:"view-apps",onTabShow:function(){return i("apps")},tab:!0,url:"/apps/"}),r.a.createElement(Y.a,{id:"view-arcade",onTabShow:function(){return i("arcade")},tab:!0,url:"/arcade/"}),r.a.createElement(Y.a,{id:"view-chat-list",onTabShow:function(){return i("chat-list")},main:!0,tabActive:!0,tab:!0,url:"/chat-list/"}))))}},{path:"/chat/(.*)",component:ye},{path:"/apps/",component:ce},{path:"/arcade/",component:pe},{path:"/chat-list/",component:de},{path:"/app/:id",asyncComponent:function(){return a.e(3).then(a.bind(null,183))}},{path:"/account/",popup:{asyncComponent:function(){return a.e(1).then(a.bind(null,181))}}},{path:"(.*)",asyncComponent:function(){return a.e(0).then(a.bind(null,182))}}];function Ce(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ie(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(a),!0).forEach((function(t){j()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ce(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Te(e,t){switch(t.type){case oe.Types.REFRESH_CHAT_LIST:return Ie({},e,{ChatList:t.data});case"FETCH_MORE_CHAT_LIST":return Ie({},e,{ChatList:[].concat(N()(e.ChatList),[{},{},{},{},{},{},{},{},{},{}])});case oe.Types.JOIN_CHAT:var a,n;if(null!=(null===(a=e.CurrentChat)||void 0===a?void 0:a.ScheduledTaskId))clearInterval(null===(n=e.CurrentChat)||void 0===n?void 0:n.ScheduledTaskId);return Ie({},e,{CurrentChat:{Id:t.data.Id,ScheduledTaskId:t.data.ScheduledTaskId}});case oe.Types.OPEN_PLAYLIST:return Ie({},e,{OpenedPlaylist:{Id:t.data,Loadding:!0,Playlist:null}});case oe.Types.UPDATE_CURRENT_OPNED_PLAYLIST:return Ie({},e,{OpenedPlaylist:{Id:t.data,Loadding:!1,Playlist:t.data}});case oe.Types.UPDATE_CURRENT_CHAT_DETAIL:return Ie({},e,{CurrentChat:Ie({},e.CurrentChat,{Id:t.data.ID,LastUpdateTimestamp:t.data.LastUpdateTimestamp,HeadTimestamp:t.data.HeadTimestamp,Name:t.data.Name,Songs:t.data.Songs})});case oe.Types.APPEND_CURRENT_CHAT_MESSAGE:var r,i;return Ie({},e,{CurrentChat:Ie({},e.CurrentChat,{Messages:[].concat(N()((null==e||null===(r=e.CurrentChat)||void 0===r?void 0:r.Messages)?null==e||null===(i=e.CurrentChat)||void 0===i?void 0:i.Messages:[]),N()(t.data))})});case"EXIT_CHAT":var c,s;if(null!=(null===(c=e.CurrentChat)||void 0===c?void 0:c.ScheduledTaskId))clearInterval(null===(s=e.CurrentChat)||void 0===s?void 0:s.ScheduledTaskId);return MusicKit.getInstance().player.pause(),MusicKit.getInstance().setQueue({}),MusicKit.configure({developerToken:"eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjNBTDk4M1lBS1gifQ.eyJpYXQiOjE2NjcxNDgwMzYsImV4cCI6MTY4MjcwMDAzNiwiaXNzIjoiTk43MkZINllSMyJ9.UfXiBOYyVOGOSs98-Mc07KxdA8SWp_7g-ZyYjHPkmV8Atf-WeV_LZtI8vS81-xvvB9yTGx_Wgt9fLnt_tmDNDw",app:{name:"DogeDock",build:"1978.4.1"}}),Ie({},e,{CurrentChat:null});case"HIDE_CHAT_MESSAGE_WINDOW":return Ie({},e,{CurrentChat:Ie({},e.CurrentChat,{MessageWindowShow:!1})});case"SHOW_CHAT_MESSAGE_WINDOW":return W.a.views.current.router.navigate("/chat/"),Ie({},e,{CurrentChat:Ie({},e.CurrentChat,{MessageWindowShow:!0})});case oe.Types.UPDATE_CHAT_LIST:return Ie({},e,{ChatList:t.data});case oe.Types.UPDATE_LIBRARY_PLAYLISTS:return Ie({},e,{My:Ie({},e.My,{LibraryPlaylists:t.data})});case oe.Types.UPDATE_MUSIC_PLAYER_DETAIL:return Ie({},e,{MusicPlayer:t.data});case oe.Types.UPDATE_USER_ID:return Ie({},e,{User:Ie({},e.User,{Id:t.data})})}}var be=function(){var e,t,a,i,c,s,l,o=Object(n.useState)(void 0),u=M()(o,2),p=u[0],d=(u[1],Object(n.useReducer)(Te,{ChatList:[],My:{LibraryPlaylists:[]}})),h=M()(d,2),f=h[0],m=h[1],v=Object(n.useRef)(f);v.current=f,null!=p&&clearInterval(p);var y=Object(n.useState)(""),g=M()(y,2),E=g[0],C=(g[1],Object(n.useRef)(null));Object(n.useEffect)((function(){setInterval((function(){var e,t,a,n,r,i;oe.UpdateMusicPlayerDetail(MusicKit.getInstance().player.currentPlaybackTime/MusicKit.getInstance().player.currentPlaybackDuration*100,null===(e=MusicKit.getInstance().player.nowPlayingItem)||void 0===e||null===(t=e.attributes)||void 0===t?void 0:t.name,null===(a=MusicKit.getInstance().player.nowPlayingItem)||void 0===a||null===(n=a.attributes)||void 0===n||null===(r=n.artwork)||void 0===r||null===(i=r.url)||void 0===i?void 0:i.replace("{w}x{h}","96x96"),m)}),1e3)}),[]),Object(n.useEffect)((function(){C.current=E}),[E]),Object(n.useEffect)((function(){if((W.a.device.ios||W.a.device.android)&&W.a.device.standalone){var e=document.querySelector('meta[name="viewport"]').getAttribute("content");document.querySelector('meta[name="viewport"]').setAttribute("content","".concat(e,", maximum-scale=1, user-scalable=no"))}}),[]);var I={name:"App Store",theme:"ios",routes:Ee,autoDarkTheme:!0,navbar:{scrollTopOnTitleClick:!1}};return te.init(),Object(n.useEffect)(D()(k.a.mark((function e(){var t,a,n,r;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=function(){return(r=D()(k.a.mark((function e(){var t,a,r,i,c,s,l,o,u,p,d,h=arguments;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=h.length>0&&void 0!==h[0]&&h[0],MusicKit.getInstance().player._next=function(){n(!1)},t&&setTimeout((function(){return n(!0)}),5e3),e.prev=3,i=null===(a=v.current.CurrentChat)||void 0===a?void 0:a.HeadTimestamp,c=null===(r=v.current.CurrentChat)||void 0===r?void 0:r.Songs,s=0;case 7:if(!((null==c?void 0:c.length)>0)){e.next=38;break}if(l=s%(null==c?void 0:c.length),!(i+c[l].Duration>Date.now()/1e3)){e.next=34;break}if(MusicKit.getInstance().player._currentPlayer.audio.paused||MusicKit.getInstance().player._currentPlayer.isPlaying||(console.log("alert!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),MusicKit.configure({developerToken:"eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IjNBTDk4M1lBS1gifQ.eyJpYXQiOjE2NjcxNDgwMzYsImV4cCI6MTY4MjcwMDAzNiwiaXNzIjoiTk43MkZINllSMyJ9.UfXiBOYyVOGOSs98-Mc07KxdA8SWp_7g-ZyYjHPkmV8Atf-WeV_LZtI8vS81-xvvB9yTGx_Wgt9fLnt_tmDNDw",app:{name:"DogeDock",build:"1978.4.1"}})),console.log(c[l]),0!=MusicKit.getInstance().player.queue.items.length||0==c.length){e.next=15;break}return e.next=15,MusicKit.getInstance().setQueue({songs:c.map((function(e){return e.SID}))});case 15:if((null===(o=MusicKit.getInstance().player.nowPlayingItem)||void 0===o||null===(u=o.attributes)||void 0===u||null===(p=u.playParams)||void 0===p?void 0:p.id)==c[l].SID){e.next=21;break}return console.log("change",c[l]),e.next=19,MusicKit.getInstance().setQueue({song:c[l].SID});case 19:return e.next=21,MusicKit.getInstance().player.changeToMediaAtIndex(0);case 21:if(!(MusicKit.getInstance().player.currentBufferedProgress*MusicKit.getInstance().player.currentPlaybackDuration/100>Date.now()/1e3-i)){e.next=27;break}if(!(Math.abs(MusicKit.getInstance().player.currentPlaybackTime-(Date.now()/1e3-i))>1.5)){e.next=27;break}return console.log("seek",Date.now()/1e3-i),e.next=26,MusicKit.getInstance().player.seekToTime(Date.now()/1e3-i);case 26:console.log("seek end");case 27:if(MusicKit.getInstance().player.isPlaying){e.next=31;break}return console.log("play !!!!!!!!!!!!!!",MusicKit.getInstance().player.isPlaying,MusicKit.getInstance().player.isReady),e.next=31,MusicKit.getInstance().player.play();case 31:return e.abrupt("break",38);case 34:i+=null===(d=v.current.CurrentChat)||void 0===d?void 0:d.Songs[l].Duration;case 35:s++,e.next=7;break;case 38:e.next=43;break;case 40:e.prev=40,e.t0=e.catch(3),console.error(e.t0);case 43:case"end":return e.stop()}}),e,null,[[3,40]])})))).apply(this,arguments)},n=function(){return r.apply(this,arguments)},function(e){for(var t=0;t<MusicKit.getInstance().player.queue.items.length;t++)if(MusicKit.getInstance().player.queue.items[t].id==e)return t;return-1},a=function(){return(a=D()(k.a.mark((function e(){var a,n,r,i;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{i=localStorage.getItem("UserId"),null==(null===(a=f.User)||void 0===a?void 0:a.Id)&&null!=i&&m({type:oe.Types.UPDATE_USER_ID,data:localStorage.getItem("UserId")}),null!=(null===(n=v.current)||void 0===n||null===(r=n.CurrentChat)||void 0===r?void 0:r.Id)&&(null==v.current.CurrentChat.Messages||0==v.current.CurrentChat.Messages.length?oe.FetchMessageAsync(v.current.CurrentChat.Id,-2,m):oe.FetchMessageAsync(v.current.CurrentChat.Id,v.current.CurrentChat.Messages.at(-1).ID,m))}finally{setTimeout(t,1e3)}case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},(t=function(){return a.apply(this,arguments)})(),document.addEventListener("click",(function(){return n(!1)})),MusicKit.getInstance().player.__next=MusicKit.getInstance().player._next,n(!0);case 9:case"end":return e.stop()}}),e)}))),[]),r.a.createElement(K.a,I,r.a.createElement(H.Provider,{value:{state:f,dispatch:m}},r.a.createElement(Y.a,{url:"/"},f.CurrentChat?r.a.createElement(F.a,{scrollTopOnTitleClick:!1,className:"chat-music-navbar"},r.a.createElement("div",{className:"title",style:{width:"100%"}},r.a.createElement(G.a,{noGap:!0,className:"chat-music-player",style:{display:"flex"}},r.a.createElement("img",{slot:"media",src:null===(e=f.MusicPlayer)||void 0===e?void 0:e.Image,width:"96px",height:"96px"}),r.a.createElement(G.a,{noGap:!0,style:{width:"0px"}},r.a.createElement(J.a,{width:"100",style:{height:"96px"}},r.a.createElement(G.a,{noGap:!0,style:{height:"92px"}},r.a.createElement(J.a,{width:"50",style:{overflow:"hidden"}},r.a.createElement("p",null," ",null===(t=f.CurrentChat)||void 0===t?void 0:t.Name," "),r.a.createElement("p",null,null===(a=f.MusicPlayer)||void 0===a?void 0:a.Name)),r.a.createElement(J.a,{width:"50",style:{height:"92px"}},r.a.createElement(G.a,{noGap:!0,style:{height:"56px"}}),r.a.createElement(G.a,{noGap:!0,style:{height:"36px"}},r.a.createElement(J.a,{width:"25"},r.a.createElement(B.a,{color:"red",iconF7:"xmark",onClick:function(){console.log(W.a.views.current.router.back()),m({type:"EXIT_CHAT"})}})),r.a.createElement(J.a,{width:"25"},r.a.createElement(B.a,{iconF7:"person_2_fill",popupOpen:".chat-member-list"})),r.a.createElement(J.a,{width:"25"},r.a.createElement(B.a,{iconF7:"list_number",popupOpen:".chat-music-list"})),r.a.createElement(J.a,{width:"25"},r.a.createElement(B.a,{onClick:function(){var e;(null===(e=f.CurrentChat)||void 0===e?void 0:e.MessageWindowShow)?(W.a.views.current.router.back(),m({type:"HIDE_CHAT_MESSAGE_WINDOW"})):(W.a.views.current.router.navigate("/chat/123"),m({type:"SHOW_CHAT_MESSAGE_WINDOW"}))},iconF7:"chat_bubble_fill",fill:null===(i=f.CurrentChat)||void 0===i?void 0:i.MessageWindowShow}))))),r.a.createElement(G.a,{style:{height:"4px"}},r.a.createElement(V.a,{style:{height:"4px"},progress:null===(c=f.MusicPlayer)||void 0===c?void 0:c.Progress,id:"chat-music-player-progressbar"}))))))):null,r.a.createElement(X.a,{className:"chat-music-list",swipeToClose:!0},r.a.createElement(S.a,null,r.a.createElement(F.a,{title:"播放列表"},r.a.createElement(q.a,null,r.a.createElement(z.a,{popupClose:!0},"Close"))),r.a.createElement(Z.a,{mediaList:!0},null===(s=f.CurrentChat)||void 0===s||null===(l=s.Songs)||void 0===l?void 0:l.map((function(e){return r.a.createElement(Q.a,{title:e.Name})}))))),r.a.createElement(X.a,{className:"chat-member-list",swipeToClose:!0},r.a.createElement(S.a,null,r.a.createElement(F.a,{title:"chat-member-list"},r.a.createElement(q.a,null,r.a.createElement(z.a,{popupClose:!0},"Close"))),r.a.createElement($.a,null,"Coming soon"))))))};P.use(s.a),c.a.render(r.a.createElement(be),document.getElementById("app"))},52:function(e,t,a){e.exports=a.p+"images/avatar.ffc8a1.jpeg"},87:function(e,t,a){"use strict";var n=a(0),r=a.n(n);a(172);t.a=function(e){var t=e.title,a=e.children;return(r.a.createElement("div",{className:"block-title appstore-block-title"},t&&r.a.createElement("span",null,t),a))}}});
//# sourceMappingURL=app.fcf8b5.js.map